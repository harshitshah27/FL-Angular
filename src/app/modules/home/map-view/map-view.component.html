<div class="map-view-container flex">
    <div class="ride-details w-full">
        <mat-sidenav-container class="!inline">
            <mat-sidenav #sidenav mode="side" opened>
                <div class="grey-padding bg-[#f8f8f8]">
                    <div class="ride-info flex items-center bg-[#E0F2EF]">
                        <mat-icon
                            class="text-[#13AC8F] bg-[#B4F9EC] mr-2">directions_bus</mat-icon>
                        <div class="info-box">
                            <div class="title uppercase">{{rideObject.name}}</div>
                            <div class="description">Number of passengers:
                                {{rideObject.ridersCount}}
                            </div>
                        </div>
                    </div>
                    <div class="bus-selection mt-4">
                        <div class="title text-[#0A0A0A] mb-1">Buses</div>
                        <section>
                            <ul class="flex">
                                <li class="bg-[#FBEAEF]">
                                    <mat-checkbox [(ngModel)]="allBusViewDetails"
                                        (ngModelChange)="viewBusDetails(true)">
                                        All
                                    </mat-checkbox>
                                </li>
                                <li *ngFor="let bus of rideObject.bus"
                                    class="bg-[#FBEAEF]">
                                    <mat-checkbox [(ngModel)]="bus.viewDetails"
                                        (ngModelChange)="viewBusDetails(false)">
                                        {{bus.name}}
                                    </mat-checkbox>
                                </li>
                            </ul>
                        </section>
                    </div>
                </div>
                <div class="details-section">
                    <div class="view-details-title text-[#0A0A0A]"> View Details</div>
                    <mat-tab-group color="transparent">
                        <ng-container *ngFor="let bus of rideObject.bus">
                            <mat-tab *ngIf="bus.viewDetails" label="{{bus.name}}">
                                <div
                                    class="bus-number flex items-center bg-[#FFF7E9] mt-3 mb-3">
                                    <mat-icon
                                        class="text-[#F29900] bg-[#F8E1BA] mr-2">directions_bus</mat-icon>
                                    <div class="info-box">
                                        <div class="description">Bus Number</div>
                                        <div class="title">{{bus.busNumber}} </div>
                                    </div>
                                </div>
                                <div class="bus-copy flex items-center mb-3">
                                    <mat-icon
                                        class="text-[#06038D] bg-[#EAE9FE] mr-2">link</mat-icon>
                                    <div class="">
                                        <div class="title text-[#A7A7A7]">Google Maps Link
                                        </div>
                                        <a class="link-text font-bold">{{bus.gMapLink}}
                                        </a>
                                    </div>
                                    <mat-icon
                                        class="text-[#06038D] cursor-pointer">content_copy</mat-icon>
                                    <span
                                        class="text-[#06038D] cursor-pointer">Copy</span>
                                </div>
                                <div class="stops-table-container">
                                    <table class="w-full">
                                        <tr>
                                            <th class="bg-[#E7E7FC]">Stops</th>
                                            <th class="bg-[#E7E7FC]">Number of Riders</th>
                                        </tr>
                                        <tr
                                            *ngFor="let stop of bus.stops, let first=first, let last=last">
                                            <td class="first-col">
                                                <div class="border-class relative">
                                                    <div class="border-left"></div>
                                                    <div class="bullet absolute"></div>
                                                    <div class="stop-name text-[#0a0a0a]">
                                                        {{stop.stopName}}
                                                    </div>
                                                    <span
                                                        class="location-text text-[#A7A7A7]">
                                                        {{stop.stopLocation}}
                                                    </span>
                                                    <span *ngIf="first"
                                                        class="italic start-point rounded-full text-[#0FB86F]">
                                                        Starting Point
                                                    </span>
                                                    <span *ngIf="last"
                                                        class="italic end-point rounded-full text-[#F65C90]">
                                                        End Point
                                                    </span>
                                                </div>
                                            </td>
                                            <td>
                                                <div
                                                    class="count-text w-fit text-[#F65C61] m-auto">
                                                    {{stop.ridersCount}}
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </mat-tab>
                        </ng-container>
                    </mat-tab-group>
                </div>
            </mat-sidenav>
            <mat-sidenav-content>
                <div class="map-container flex">
                    <button mat-flat-button (click)="sidenav.toggle()" class="bg-[#fff]">
                        <mat-icon class="play-toggle-icon text-[#20C170]"
                            [ngClass]="{'clicked':sidenav.opened}">play_arrow</mat-icon>
                    </button>
                    <div class="map-wrapper w-full">
                        <google-map [height]="'100%'" [width]="'100%'"
                            [options]="mapOptions">
                            <map-marker *ngFor="let marker of markers"
                                [position]="marker.position"
                                [title]="marker.title"></map-marker>
                            <!-- <map-marker [position]="marker.position"></map-marker> -->
                        </google-map>
                    </div>
                </div>

            </mat-sidenav-content>
        </mat-sidenav-container>
    </div>
    <div class="action-buttons flex absolute">
        <mat-tab-group color="transparent" class="z-0">
            <mat-tab label="Faster Driver"> </mat-tab>
            <mat-tab label="Shorter Walk"> </mat-tab>
            <mat-tab label="Point to Point"> </mat-tab>
        </mat-tab-group>
        <button mat-flat-button
            class="!flex items-center justify-center !bg-[#06038d] !text-[#fff] all-riders-btn"
            (click)="toggleViewAllRiders()">
            <mat-icon class="mr-1">directions_walk</mat-icon>
            <span>All Riders</span>
        </button>
    </div>

</div>

<app-all-riders *ngIf="viewAllRiders" [allRidersData]="allRidersData"
    (closeAllRiders)="toggleViewAllRiders()"></app-all-riders>